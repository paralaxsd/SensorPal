<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="SensorPal.Mobile.Pages.EventsPage"
             Title="Events">

    <VerticalStackLayout Padding="16" Spacing="12">

        <!-- Date picker -->
        <HorizontalStackLayout Spacing="12" HorizontalOptions="Center">
            <Button Text="◀" WidthRequest="44" Clicked="OnPrevDayClicked" />
            <DatePicker x:Name="DateSelector"
                        Format="dd.MM.yyyy"
                        DateSelected="OnDateSelected"
                        VerticalOptions="Center" />
            <Button Text="▶" WidthRequest="44" Clicked="OnNextDayClicked" />
        </HorizontalStackLayout>

        <!-- Event list -->
        <CollectionView x:Name="EventsView"
                        SelectionMode="None"
                        EmptyView="No noise events for this day."
                        VerticalOptions="FillAndExpand">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Margin="0,4" Padding="12" CornerRadius="8" BorderColor="LightGray">
                        <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto" RowSpacing="4">
                            <Label Grid.Row="0" Grid.Column="0"
                                   Text="{Binding DetectedAt, StringFormat='{0:HH:mm:ss}'}"
                                   FontAttributes="Bold" FontSize="16" />
                            <Label Grid.Row="0" Grid.Column="1"
                                   Text="{Binding PeakDb, StringFormat='{0:F1} dBFS'}"
                                   TextColor="OrangeRed" VerticalOptions="Center" />
                            <Label Grid.Row="1" Grid.Column="0"
                                   Text="{Binding DurationMs, StringFormat='Duration: {0} ms'}"
                                   TextColor="Gray" FontSize="13" />
                            <Button Grid.Row="1" Grid.Column="1"
                                    Text="▶ Play"
                                    FontSize="13"
                                    IsVisible="{Binding HasClip}"
                                    Clicked="OnPlayClicked"
                                    CommandParameter="{Binding Id}" />
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!-- Playback status -->
        <Label x:Name="PlaybackLabel"
               Text=""
               HorizontalOptions="Center"
               TextColor="Gray"
               FontSize="13" />

    </VerticalStackLayout>

</ContentPage>
